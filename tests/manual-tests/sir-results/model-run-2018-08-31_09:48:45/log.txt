Generating data from model
Summary of generated model data
Wrapper around LibBi
======================
Model:  SIR 
Run time:  0.308589  seconds
Number of samples:  1 
State trajectories recorded:  S I R Z 
Noise trajectories recorded:  n_transmission n_recovery 
Observation trajectories recorded:  Incidence 
Parameters recorded:  p_rep p_R0 
Variables in the generated data
[1] "Incidence"
Load the model as a compiled libbi object
Adapting particles starting with 16 up to a maximum of 128
Adapting particles iteration: 1
Initial sampling using the prior as the proposal.
Starting particle adaption
Fri Aug 31 09:49:45 2018 Adapting the number of particles
Fri Aug 31 09:50:16 2018 16 particles, loglikelihod variance: 1.962195207978
Fri Aug 31 09:50:33 2018 32 particles, loglikelihod variance: 3.0342554918425
Fri Aug 31 09:51:14 2018 64 particles, loglikelihod variance: 1.95809168079997
Fri Aug 31 09:52:31 2018 128 particles, loglikelihod variance: 1.02093992231825
Fri Aug 31 09:52:31 2018 Choosing 128 particles.
Adapting particles iteration: 2
Initial sampling using the prior as the proposal.
Starting particle adaption
Fri Aug 31 09:53:17 2018 Adapting the number of particles
Fri Aug 31 09:53:47 2018 16 particles, loglikelihod variance: 3.30476248029504
Fri Aug 31 09:53:57 2018 32 particles, loglikelihod variance: 1.9304799196643
Fri Aug 31 09:54:13 2018 64 particles, loglikelihod variance: 1.41926023247467
Fri Aug 31 09:54:37 2018 128 particles, loglikelihod variance: 0.820817394524081
Fri Aug 31 09:54:37 2018 Choosing 128 particles.
Adapting particles iteration: 3
Initial sampling using the prior as the proposal.
Starting particle adaption
Fri Aug 31 09:55:10 2018 Adapting the number of particles
Fri Aug 31 09:55:46 2018 16 particles, loglikelihod variance: 2.74822741759695
Fri Aug 31 09:56:10 2018 32 particles, loglikelihod variance: 1.93965952837901
Fri Aug 31 09:56:28 2018 64 particles, loglikelihod variance: 1.3110702890059
Fri Aug 31 09:56:51 2018 128 particles, loglikelihod variance: 0.717613515427789
Fri Aug 31 09:56:51 2018 Choosing 128 particles.
Adapting particles iteration: 4
Initial sampling using the prior as the proposal.
Starting particle adaption
Fri Aug 31 09:57:31 2018 Adapting the number of particles
Fri Aug 31 09:57:59 2018 16 particles, loglikelihod variance: 2.96646258475082
Fri Aug 31 09:58:15 2018 32 particles, loglikelihod variance: 3.45781768179414
Fri Aug 31 09:58:30 2018 64 particles, loglikelihod variance: 1.32790144878543
Fri Aug 31 09:58:52 2018 128 particles, loglikelihod variance: 1.2715825179558
Fri Aug 31 09:58:52 2018 Choosing 128 particles.
Adapting particles iteration: 5
Initial sampling using the prior as the proposal.
Starting particle adaption
Fri Aug 31 09:59:20 2018 Adapting the number of particles
Fri Aug 31 09:59:49 2018 16 particles, loglikelihod variance: 2.03602546227373
Fri Aug 31 10:00:01 2018 32 particles, loglikelihod variance: 3.97547312373723
Fri Aug 31 10:00:16 2018 64 particles, loglikelihod variance: 1.15716435703141
Fri Aug 31 10:00:37 2018 128 particles, loglikelihod variance: 0.726345012828597
Fri Aug 31 10:00:37 2018 Choosing 128 particles.
Choosing 128based on 5 iterations each using 1000.
The maximum number of particles selected was 128 with a minimum of128
The mean number of particles selected was 128 with a standard deviation of 0
Adapting proposal with a min acceptance of 0.1 and a maximum acceptance of 0.4
Running for 1000 with 10 samples each time.
Fri Aug 31 10:01:14 2018 Adapting the proposal distribution
Fri Aug 31 10:01:14 2018 Acceptance rate 0.00300300300300305, adapting size with scale 1
Fri Aug 31 10:01:54 2018 Acceptance rate 0.00700700700700696, adapting size with scale 0.5
Fri Aug 31 10:02:34 2018 Acceptance rate 0.005005005005005, adapting size with scale 0.25
Fri Aug 31 10:03:14 2018 Acceptance rate 0.00800800800800805, adapting size with scale 0.125
Fri Aug 31 10:03:50 2018 Acceptance rate 0.00600600600600598, adapting size with scale 0.0625
Fri Aug 31 10:04:27 2018 Acceptance rate 0.00600600600600598, adapting size with scale 0.03125
Fri Aug 31 10:05:05 2018 Acceptance rate 0.00600600600600598, adapting size with scale 0.015625
Fri Aug 31 10:05:41 2018 Acceptance rate 0.00600600600600598, adapting size with scale 0.0078125
Fri Aug 31 10:06:19 2018 Acceptance rate 0.00600600600600598, adapting size with scale 0.00390625
Fri Aug 31 10:06:59 2018 Acceptance rate 0.00400400400400402, adapting size with scale 0.001953125
Fri Aug 31 10:07:40 2018 Acceptance rate 0, adapting shape with scale 1
Fri Aug 31 10:08:22 2018 Acceptance rate: 0.232232232232232
Adapted proposal distribution
[1] "p_rep ~ truncated_gaussian(mean = p_rep, std = 0.2, lower = 0, upper = 1)"
[2] "p_R0 ~ truncated_gaussian(mean = p_R0, std = 0.3, lower = 1, upper = 3)"  
[1] "S <- N - 1" "I <- 1"     "R <- 0"     "Z <- 1"    
Fitting using PMCMC
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpBWeFFH/SIR28f77c35278c;/usr/local/bin/libbi sample --seed 224875329 --obs-file /tmp/RtmpBWeFFH/SIR28f77c35278c/SIR_obs28f77e28c638.nc --end-time 112 --noutputs 112 --nparticles 128 --nthreads 8 --verbose --nsamples 10000 --init-file /tmp/RtmpBWeFFH/SIR28f77c35278c/SIR_init28f7424c5d26.nc --target posterior --output-file /tmp/RtmpBWeFFH/SIR28f77c35278c/SIR_output28f720bef5fb.nc --model-file /tmp/RtmpBWeFFH/SIR28f77c35278c/SIR_model28f71f3d180c.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
[1] "... LibBi has finished!"
Summary of fitted model
Wrapper around LibBi
======================
Model:  SIR 
Run time:  372.8424  seconds
Number of samples:  10000 
State trajectories recorded:  S I R Z 
Noise trajectories recorded:  n_transmission n_recovery 
Observation trajectories recorded:  Incidence 
Parameters recorded:  p_rep p_R0 
Plot posterior
Plotting: densities
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Saving 7 x 7 in image
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Plotting: traces
Saving 7 x 7 in image
Model DIC: 121.210439813259
