Plot historic number of pulmonary cases detected each year:
Saving 7 x 7 in image
Plot number of cases detected each year:
geom_path: Each group consists of only one observation. Do you need to adjust
the group aesthetic?
Saving 7 x 7 in image
geom_path: Each group consists of only one observation. Do you need to adjust
the group aesthetic?
Plot number of cases detected each year, stratified by age group:
Using 4 particles based on the number of observed data samples (rounded to the nearest power of 2).
Using a minimum of 4 particles based on the number of particles specified.
Using a maximum of 16 particles based on the minimum number of particles times by 4.
Load the model as a compiled libbi object
Sample priors
Launching LibBi...
Parsing...
Processing arguments...
Transforming model...
Generating Doxyfile...
Generating C++ code...
Generating GNU autotools build system...
Building...
Running...
...LibBi has finished!
Summary of prior sampling
Wrapper around LibBi
======================
Model:  Baseline 
Run time:  330.4756  seconds
Number of samples:  1000 
State trajectories recorded:  foi S H L P E T YearlyPulCases YearlyEPulCases YearlyDeaths YearlyPAgeCases YearlyPCases YearlyEAgeCases YearlyECases YearlyAgeCases YearlyCases YearlyNonUKborn 
Observation trajectories recorded:  YearlyHistPInc YearlyInc YearlyAgeInc YearlyChildInc YearlyAdultInc YearlyOlderAdultInc 
Parameters recorded:  M c_eff c_hist beta_child_mod beta_older_adult_mod delta epsilon_h_0_4 epsilon_h_5_14 epsilon_h_15_89 kappa_0_4 kappa_5_14 kappa_15_89 epsilon_l_0_4 epsilon_l_5_14 epsilon_l_15_89 phi_0_14 phi_15_69 phi_70_89 Upsilon_0_14 Upsilon_15_69 Upsilon_70_89 rho_0_14 rho_15_69 rho_70_89 nu_p_0_14 nu_p_15_89 nu_e_0_14 nu_e_15_89 zeta_0_14 zeta_15_69 zeta_70_89 mu_t_0_14 mu_t_15_69 mu_t_70_89 chi_init alpha_t_init alpha_t_decay HistMeasError 
Load priors
Plot priors
Plotting: densities
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Saving 7 x 7 in image
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Plotting: traces
Saving 7 x 7 in image
Optimising the deterministic model
Launching LibBi...
Parsing...
Processing arguments...
Transforming model...
Generating Doxyfile...
Generating C++ code...
Generating GNU autotools build system...
Building...
Running...
...LibBi has finished!
Taking a 100 samples from the posterior to estimate
              the acceptance rate as proposal adaption has not been run.
Launching LibBi...
Parsing...
Processing arguments...
Transforming model...
Generating Doxyfile...
Generating C++ code...
Generating GNU autotools build system...
Building...
Running...
...LibBi has finished!
Acceptance rate of 0.0303030303030303 after adapting the proposal
Using 3 rejuvernation moves in order to target at least a 10% acceptence rate for each rejuvernation sample.
Fitting using SMC-SMC
Launching LibBi...
/usr/local/bin/libbi sample --noutputs 73 --end-time 73 --nparticles 4 --nthreads 4 --verbose --seed 1261571501 --input-file /tmp/RtmpwSJLXW/Baseline98bf69d75bf6/Baseline_input98bf234dfdc6.nc --obs-file /tmp/RtmpwSJLXW/Baseline98bf69d75bf6/Baseline_obs98bf21572ada.nc --target posterior --nsamples 1000 --init-file /tmp/RtmpwSJLXW/Baseline98bf69d75bf6/Baseline_init98bf7a178fb6.nc --sampler sir --adapter global --sample-ess-rel 0.1 --nmoves 3 --tmoves 0 --with-transform-obs-to-state --with-transform-initial-to-param --output-file /tmp/RtmpwSJLXW/Baseline98bf69d75bf6/Baseline_output98bf745ed032.nc --model-file /tmp/RtmpwSJLXW/Baseline98bf69d75bf6/Baseline_model.bi
Parsing...
Processing arguments...
Transforming model...
Generating Doxyfile...
Generating C++ code...
Generating GNU autotools build system...
make -j 4  sample_cpu
Building...
depbase=`echo src/sample_cpu.o | sed 's|[^/]*$|.deps/&|;s|\.o$||'`;\
g++ -DPACKAGE_NAME=\"LibBi\" -DPACKAGE_TARNAME=\"libbi\" -DPACKAGE_VERSION=\"1.4.2\" -DPACKAGE_STRING=\"LibBi\ 1.4.2\" -DPACKAGE_BUGREPORT=\"bug-report@libbi.org\" -DPACKAGE_URL=\"http://www.libbi.org\" -DHAVE_OMP_H=1 -DTHRUST_DEVICE_SYSTEM=THRUST_DEVICE_SYSTEM_CPP -DTHRUST_HOST_SYSTEM=THRUST_HOST_SYSTEM_OMP -DHAVE_LIBM=1 -DHAVE_LIBGFORTRAN=1 -DHAVE_LIBQRUPDATE=1 -DHAVE_LIBGSL=1 -DHAVE_LIBNETCDF=1 -DHAVE_NETCDF_H=1 -DHAVE_CBLAS_H=1 -DHAVE_GSL_GSL_CBLAS_H=1 -DHAVE_BOOST_MPL_IF_HPP=1 -DHAVE_BOOST_RANDOM_BINOMIAL_DISTRIBUTION_HPP=1 -DHAVE_BOOST_RANDOM_BERNOULLI_DISTRIBUTION_HPP=1 -DHAVE_BOOST_RANDOM_GAMMA_DISTRIBUTION_HPP=1 -DHAVE_BOOST_RANDOM_MERSENNE_TWISTER_HPP=1 -DHAVE_BOOST_RANDOM_NORMAL_DISTRIBUTION_HPP=1 -DHAVE_BOOST_RANDOM_POISSON_DISTRIBUTION_HPP=1 -DHAVE_BOOST_RANDOM_UNIFORM_INT_HPP=1 -DHAVE_BOOST_RANDOM_UNIFORM_REAL_HPP=1 -DHAVE_BOOST_RANDOM_VARIATE_GENERATOR_HPP=1 -DHAVE_BOOST_TYPEOF_TYPEOF_HPP=1 -DHAVE_THRUST_ADJACENT_DIFFERENCE_H=1 -DHAVE_THRUST_BINARY_SEARCH_H=1 -DHAVE_THRUST_COPY_H=1 -DHAVE_THRUST_DEVICE_PTR_H=1 -DHAVE_THRUST_DISTANCE_H=1 -DHAVE_THRUST_EXTREMA_H=1 -DHAVE_THRUST_FILL_H=1 -DHAVE_THRUST_FOR_EACH_H=1 -DHAVE_THRUST_FUNCTIONAL_H=1 -DHAVE_THRUST_GATHER_H=1 -DHAVE_THRUST_INNER_PRODUCT_H=1 -DHAVE_THRUST_ITERATOR_COUNTING_ITERATOR_H=1 -DHAVE_THRUST_ITERATOR_DETAIL_NORMAL_ITERATOR_H=1 -DHAVE_THRUST_ITERATOR_DISCARD_ITERATOR_H=1 -DHAVE_THRUST_ITERATOR_PERMUTATION_ITERATOR_H=1 -DHAVE_THRUST_ITERATOR_TRANSFORM_ITERATOR_H=1 -DHAVE_THRUST_ITERATOR_ZIP_ITERATOR_H=1 -DHAVE_THRUST_LOGICAL_H=1 -DHAVE_THRUST_REDUCE_H=1 -DHAVE_THRUST_SCAN_H=1 -DHAVE_THRUST_SEQUENCE_H=1 -DHAVE_THRUST_SORT_H=1 -DHAVE_THRUST_TRANSFORM_H=1 -DHAVE_THRUST_TRANSFORM_REDUCE_H=1 -DHAVE_THRUST_TRANSFORM_SCAN_H=1 -DHAVE_THRUST_TUPLE_H=1 -DHAVE_GSL_GSL_MULTIMIN_H=1 -DENABLE_DIAGNOSTICS=no -I.  -Isrc  -I/usr/local/cuda/include    -DCUDA_FAST_MATH=0    -DENABLE_OPENMP    -fopenmp -O3 -g3 -funroll-loops   -MT src/sample_cpu.o -MD -MP -MF $depbase.Tpo -c -o src/sample_cpu.o src/sample_cpu.cpp &&\
mv -f $depbase.Tpo $depbase.Po
depbase=`echo src/model/ModelBaseline_model.o | sed 's|[^/]*$|.deps/&|;s|\.o$||'`;\
g++ -DPACKAGE_NAME=\"LibBi\" -DPACKAGE_TARNAME=\"libbi\" -DPACKAGE_VERSION=\"1.4.2\" -DPACKAGE_STRING=\"LibBi\ 1.4.2\" -DPACKAGE_BUGREPORT=\"bug-report@libbi.org\" -DPACKAGE_URL=\"http://www.libbi.org\" -DHAVE_OMP_H=1 -DTHRUST_DEVICE_SYSTEM=THRUST_DEVICE_SYSTEM_CPP -DTHRUST_HOST_SYSTEM=THRUST_HOST_SYSTEM_OMP -DHAVE_LIBM=1 -DHAVE_LIBGFORTRAN=1 -DHAVE_LIBQRUPDATE=1 -DHAVE_LIBGSL=1 -DHAVE_LIBNETCDF=1 -DHAVE_NETCDF_H=1 -DHAVE_CBLAS_H=1 -DHAVE_GSL_GSL_CBLAS_H=1 -DHAVE_BOOST_MPL_IF_HPP=1 -DHAVE_BOOST_RANDOM_BINOMIAL_DISTRIBUTION_HPP=1 -DHAVE_BOOST_RANDOM_BERNOULLI_DISTRIBUTION_HPP=1 -DHAVE_BOOST_RANDOM_GAMMA_DISTRIBUTION_HPP=1 -DHAVE_BOOST_RANDOM_MERSENNE_TWISTER_HPP=1 -DHAVE_BOOST_RANDOM_NORMAL_DISTRIBUTION_HPP=1 -DHAVE_BOOST_RANDOM_POISSON_DISTRIBUTION_HPP=1 -DHAVE_BOOST_RANDOM_UNIFORM_INT_HPP=1 -DHAVE_BOOST_RANDOM_UNIFORM_REAL_HPP=1 -DHAVE_BOOST_RANDOM_VARIATE_GENERATOR_HPP=1 -DHAVE_BOOST_TYPEOF_TYPEOF_HPP=1 -DHAVE_THRUST_ADJACENT_DIFFERENCE_H=1 -DHAVE_THRUST_BINARY_SEARCH_H=1 -DHAVE_THRUST_COPY_H=1 -DHAVE_THRUST_DEVICE_PTR_H=1 -DHAVE_THRUST_DISTANCE_H=1 -DHAVE_THRUST_EXTREMA_H=1 -DHAVE_THRUST_FILL_H=1 -DHAVE_THRUST_FOR_EACH_H=1 -DHAVE_THRUST_FUNCTIONAL_H=1 -DHAVE_THRUST_GATHER_H=1 -DHAVE_THRUST_INNER_PRODUCT_H=1 -DHAVE_THRUST_ITERATOR_COUNTING_ITERATOR_H=1 -DHAVE_THRUST_ITERATOR_DETAIL_NORMAL_ITERATOR_H=1 -DHAVE_THRUST_ITERATOR_DISCARD_ITERATOR_H=1 -DHAVE_THRUST_ITERATOR_PERMUTATION_ITERATOR_H=1 -DHAVE_THRUST_ITERATOR_TRANSFORM_ITERATOR_H=1 -DHAVE_THRUST_ITERATOR_ZIP_ITERATOR_H=1 -DHAVE_THRUST_LOGICAL_H=1 -DHAVE_THRUST_REDUCE_H=1 -DHAVE_THRUST_SCAN_H=1 -DHAVE_THRUST_SEQUENCE_H=1 -DHAVE_THRUST_SORT_H=1 -DHAVE_THRUST_TRANSFORM_H=1 -DHAVE_THRUST_TRANSFORM_REDUCE_H=1 -DHAVE_THRUST_TRANSFORM_SCAN_H=1 -DHAVE_THRUST_TUPLE_H=1 -DHAVE_GSL_GSL_MULTIMIN_H=1 -DENABLE_DIAGNOSTICS=no -I.  -Isrc  -I/usr/local/cuda/include    -DCUDA_FAST_MATH=0    -DENABLE_OPENMP    -fopenmp -O3 -g3 -funroll-loops   -MT src/model/ModelBaseline_model.o -MD -MP -MF $depbase.Tpo -c -o src/model/ModelBaseline_model.o src/model/ModelBaseline_model.cpp &&\
mv -f $depbase.Tpo $depbase.Po
g++ -fopenmp -O3 -g3 -funroll-loops    -L/usr/local/cuda/lib64 -L/usr/local/cuda/lib -Wl,-rpath,/usr/local/cuda/lib64 -Wl,-rpath,/usr/local/cuda/lib -o sample_cpu src/sample_cpu.o src/model/ModelBaseline_model.o  libbi.a -lnetcdf -lgsl -lqrupdate -lopenblas -lgfortran -lm 
Running...
"/tmp/RtmpwSJLXW/Baseline98bf69d75bf6/.Baseline_model/build_assert_openmp_sm_30/sample" -C 0 --adapter=global --adapter-ess-rel=0.25 --adapter-scale=0.5 --conditional-pf=0 --end-time=73 --ess-rel=0.5 --filter=bootstrap --gperftools-file=pprof.prof --init-file=/tmp/RtmpwSJLXW/Baseline98bf69d75bf6/Baseline_init98bf7a178fb6.nc --init-np=-1 --init-ns=0 --input-file=/tmp/RtmpwSJLXW/Baseline98bf69d75bf6/Baseline_input98bf234dfdc6.nc --input-np=-1 --input-ns=0 --joint-adaptation=0 --nbridges=0 --nmoves=3 --noutputs=73 --nparticles=4 --nsamples=1000 --nthreads=4 --obs-file=/tmp/RtmpwSJLXW/Baseline98bf69d75bf6/Baseline_obs98bf21572ada.nc --obs-np=0 --obs-ns=0 --output-file=/tmp/RtmpwSJLXW/Baseline98bf69d75bf6/Baseline_output98bf745ed032.nc --resampler=systematic --role=client --sample-ess-rel=0.1 --sample-resampler=systematic --sample-stopper=deterministic --sample-stopper-max=0 --sample-stopper-threshold=0 --sampler=sir --seed=1261571501 --server-file=port_name --start-time=0 --stopper=deterministic --stopper-block=128 --stopper-max=32768 --stopper-threshold=128 --target=posterior --tmoves=0 --with-mpi=0 --with-output-at-obs=1 --with-transform-extended=0 --with-transform-initial-to-param=1 --with-transform-iterated-filtering=0 --with-transform-iterated-smoothing=0 --with-transform-obs-to-state=1 --with-transform-optimise=1
0:	time 0.000	ESS 1000.000
51:	time 51.000	ESS 1000.000
61:	time 61.000	ESS 1000.000
69:	time 69.000	ESS 1000.000sample: src/bi/state/../math/../host/math/vector.hpp:289: T& bi::host_vector_handle<T, size_value, inc_value>::operator()(bi::host_vector_handle<T, size_value, inc_value>::size_type) [with T = double; int size_value = -1; int inc_value = 1; bi::host_vector_handle<T, size_value, inc_value>::size_type = int]: Assertion `i >= 0 && i < this->size()' failed.
Aborted
