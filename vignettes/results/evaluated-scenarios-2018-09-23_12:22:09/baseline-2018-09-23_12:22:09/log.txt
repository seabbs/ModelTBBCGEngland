Plot historic number of pulmonary cases detected each year:
Saving 7 x 7 in image
Plot number of cases detected each year:
Saving 7 x 7 in image
Plot number of cases detected each year, stratified by age group:
Using 12 particles based on the number of observed data samples (rounded to the nearest multiple of 4).
Using a minimum of 12 particles based on the number of observed data samples (rounded to the nearest multiple of 4).
Using a maximum of 48 particles based on the minimum number of particles times by 4.
Load the model as a compiled libbi object
Sample priors
Summary of prior sampling
Wrapper around LibBi
======================
Model:  Baseline 
Run time:  405.4089  seconds
Number of samples:  1000 
State trajectories recorded:  foi S H L P E T_P T_E YearlyPulCases YearlyEPulCases YearlyPulDeaths YearlyEPulDeaths YearlyPAgeCases YearlyPCases YearlyEAgeCases YearlyECases YearlyAgeCases YearlyCases YearlyNonUKborn 
Observation trajectories recorded:  YearlyHistPInc YearlyInc YearlyAgeInc YearlyChildInc YearlyAdultInc YearlyOlderAdultInc 
Parameters recorded:  M c_eff c_hist beta_child_mod beta_older_adult_mod delta epsilon_h_0_4 epsilon_h_5_14 epsilon_h_15_89 kappa_0_4 kappa_5_14 kappa_15_89 epsilon_l_0_4 epsilon_l_5_14 epsilon_l_15_89 phi_0_14 phi_15_69 phi_70_89 Upsilon_0_14 Upsilon_15_69 Upsilon_70_89 rho_0_14 rho_15_69 rho_70_89 nu_p_0_14 nu_p_15_89 nu_e_0_14 nu_e_15_89 zeta_0_14 zeta_15_69 zeta_70_89 mu_p_0_14 mu_p_15_69 mu_p_70_89 mu_e_0_14 mu_e_15_69 mu_e_70_89 chi_init alpha_t_init alpha_t_decay HistMeasError 
Load priors
Plot priors
Plotting: densities
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Saving 7 x 7 in image
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Plotting: traces
Saving 7 x 7 in image
Adapting particles starting with 12 up to a maximum of 48
Adapting particles iteration: 1
Initial sampling using the prior as the proposal.
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpZXm3qS/Baselineca95645dd3a3;/usr/local/bin/libbi sample --seed 1235 --input-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_inputca9549114ad0.nc --obs-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_obsca951e29ee60.nc --noutputs 73 --end-time 73 --nparticles 12 --nthreads 4 --verbose --with-transform-initial-to-param  --nsamples 100 --output-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_outputca957876c764.nc --model-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_modelca951cc3dbfe.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
[1] "... LibBi has finished!"
Starting particle adaption
Sun Sep 23 12:40:23 2018 Adapting the number of particles
Sun Sep 23 12:50:27 2018 8 particles, loglikelihod variance: 8.44069026942115
Sun Sep 23 12:50:27 2018 Choosing 8 particles.
Adapting particles iteration: 2
Initial sampling using the prior as the proposal.
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpZXm3qS/Baselineca95645dd3a3;/usr/local/bin/libbi sample --seed 1236 --input-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_inputca9549114ad0.nc --obs-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_obsca951e29ee60.nc --noutputs 73 --end-time 73 --nparticles 12 --nthreads 4 --verbose --with-transform-initial-to-param  --nsamples 100 --output-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_outputca9510759df7.nc --model-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_modelca9540be6ccb.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
[1] "... LibBi has finished!"
Starting particle adaption
Sun Sep 23 13:00:36 2018 Adapting the number of particles
Sun Sep 23 13:08:38 2018 8 particles, loglikelihod variance: 371.636227083912
Sun Sep 23 13:23:05 2018 16 particles, loglikelihod variance: 327.656273406829
Sun Sep 23 13:59:51 2018 32 particles, loglikelihod variance: 416.036023128601
Sun Sep 23 15:10:15 2018 64 particles, loglikelihod variance: 33.1791252343845
Sun Sep 23 15:10:15 2018 Choosing 64 particles.
Adapting particles iteration: 3
Initial sampling using the prior as the proposal.
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpZXm3qS/Baselineca95645dd3a3;/usr/local/bin/libbi sample --seed 1237 --input-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_inputca9549114ad0.nc --obs-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_obsca951e29ee60.nc --noutputs 73 --end-time 73 --nparticles 12 --nthreads 4 --verbose --with-transform-initial-to-param  --nsamples 100 --output-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_outputca9522414340.nc --model-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_modelca952c643cf7.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
[1] "... LibBi has finished!"
Starting particle adaption
Sun Sep 23 15:20:52 2018 Adapting the number of particles
Sun Sep 23 15:28:02 2018 8 particles, loglikelihod variance: 7.97191656852869
Sun Sep 23 15:28:02 2018 Choosing 8 particles.
Choosing 8based on 3 iterations each using 100.
The maximum number of particles selected was 64 with a minimum of 8
The mean number of particles selected was 26.6666666666667 with a standard deviation of 32.331615074619
Adapting proposal with a min acceptance of 0.05 and a maximum acceptance of 0.3
Running for 4 iterations with 250 samples each time.
Taking initial sample to estimate acceptance rate
Adapting proposal ...
Sun Sep 23 15:46:22 2018 Adapting the proposal distribution
Sun Sep 23 15:46:23 2018 Acceptance rate 1, adapting size with scale 1
Sun Sep 23 15:59:04 2018 Acceptance rate 0.0281124497991968, adapting size with scale 0.833333333333333
Sun Sep 23 16:12:45 2018 Acceptance rate 0.0240963855421686, adapting size with scale 0.694444444444445
Sun Sep 23 16:28:50 2018 Acceptance rate 0.0120481927710844, adapting size with scale 0.578703703703704
Sun Sep 23 16:45:23 2018 Acceptance rate: 0
Adapted proposal distribution
 [1] "M ~ truncated_gaussian(mean = M, std = 0.03, lower = 0.5, upper = 1)"                         
 [2] "c_eff ~ truncated_gaussian(mean = c_eff, std = 0.1, lower = 0, upper = 5)"                    
 [3] "c_hist ~ truncated_gaussian(mean = c_hist, std = 0.08, lower = 10, upper = 15)"               
 [4] "beta_child_mod ~ truncated_gaussian(mean = beta_child_mod, std = 0.02, lower = 0)"            
 [5] "beta_older_adult_mod ~ truncated_gaussian(mean = beta_older_adult_mod, std = 0.05, lower = 0)"
 [6] "delta ~ truncated_gaussian(mean = delta, std = 0.002, lower = 0, upper = 1)"                  
 [7] "epsilon_h_0_4 ~ truncated_gaussian(mean = epsilon_h_0_4, std = 0.04, lower = 0)"              
 [8] "epsilon_h_5_14 ~ truncated_gaussian(mean = epsilon_h_5_14, std = 0.04, lower = 0)"            
 [9] "epsilon_h_15_89 ~ truncated_gaussian(mean = epsilon_h_15_89, std = 2, lower = 0)"             
[10] "kappa_0_4 ~ truncated_gaussian(mean = kappa_0_4, std = 0.05, lower = 0)"                      
[11] "kappa_5_14 ~ truncated_gaussian(mean = kappa_5_14, std = 0.06, lower = 0)"                    
[12] "kappa_15_89 ~ truncated_gaussian(mean = kappa_15_89, std = 0.1, lower = 0)"                   
[13] "epsilon_l_0_4 ~ truncated_gaussian(mean = epsilon_l_0_4, std = 70, lower = 0)"                
[14] "epsilon_l_5_14 ~ truncated_gaussian(mean = epsilon_l_5_14, std = 6, lower = 0)"               
[15] "epsilon_l_15_89 ~ truncated_gaussian(mean = epsilon_l_15_89, std = 0.3, lower = 0)"           
[16] "phi_0_14 ~ truncated_gaussian(mean = phi_0_14, std = 0.02, lower = 0)"                        
[17] "phi_15_69 ~ truncated_gaussian(mean = phi_15_69, std = 0.02, lower = 0)"                      
[18] "phi_70_89 ~ truncated_gaussian(mean = phi_70_89, std = 0.007, lower = 0)"                     
[19] "Upsilon_0_14 ~ truncated_gaussian(mean = Upsilon_0_14, std = 1e-04, lower = 0, upper = 1)"    
[20] "Upsilon_15_69 ~ truncated_gaussian(mean = Upsilon_15_69, std = 5e-04, lower = 0, upper = 1)"  
[21] "Upsilon_70_89 ~ truncated_gaussian(mean = Upsilon_70_89, std = 5e-04, lower = 0, upper = 1)"  
[22] "rho_0_14 ~ truncated_gaussian(mean = rho_0_14, std = 9e-04, lower = 0, upper = 1)"            
[23] "rho_15_69 ~ truncated_gaussian(mean = rho_15_69, std = 1e-04, lower = 0, upper = 1)"          
[24] "rho_70_89 ~ truncated_gaussian(mean = rho_70_89, std = 9e-04, lower = 0, upper = 1)"          
[25] "nu_p_0_14 ~ truncated_gaussian(mean = nu_p_0_14, std = 0.01, lower = 0)"                      
[26] "nu_p_15_89 ~ truncated_gaussian(mean = nu_p_15_89, std = 0.06, lower = 0)"                    
[27] "nu_e_0_14 ~ truncated_gaussian(mean = nu_e_0_14, std = 0.04, lower = 0)"                      
[28] "nu_e_15_89 ~ truncated_gaussian(mean = nu_e_15_89, std = 0.005, lower = 0)"                   
[29] "zeta_0_14 ~ truncated_gaussian(mean = zeta_0_14, std = 1, lower = 0)"                         
[30] "zeta_15_69 ~ truncated_gaussian(mean = zeta_15_69, std = 1, lower = 0)"                       
[31] "zeta_70_89 ~ truncated_gaussian(mean = zeta_70_89, std = 5, lower = 0)"                       
[32] "mu_p_0_14 ~ truncated_gaussian(mean = mu_p_0_14, std = 3, lower = 0)"                         
[33] "mu_p_15_69 ~ truncated_gaussian(mean = mu_p_15_69, std = 3, lower = 0)"                       
[34] "mu_p_70_89 ~ truncated_gaussian(mean = mu_p_70_89, std = 2, lower = 0)"                       
[35] "mu_e_0_14 ~ truncated_gaussian(mean = mu_e_0_14, std = 0.6, lower = 0)"                       
[36] "mu_e_15_69 ~ truncated_gaussian(mean = mu_e_15_69, std = 7, lower = 0)"                       
[37] "mu_e_70_89 ~ truncated_gaussian(mean = mu_e_70_89, std = 1, lower = 0)"                       
[38] "chi_init ~ truncated_gaussian(mean = chi_init, std = 0.01, lower = 0, upper = 1)"             
[39] "alpha_t_init ~ gaussian(mean = alpha_t_init, std = 0.05)"                                     
[40] "alpha_t_decay ~ gaussian(mean = alpha_t_decay, std = 0.02)"                                   
[41] "HistMeasError ~ truncated_gaussian(mean = HistMeasError, std = 0.01, lower = 0)"              
[1] NA
Acceptance rate of 0 after adapting the proposal
Acceptance rate is to low (0) to be tractable. Defaulting to an acceptance rate of 0.005 (leading to 100 moves per particle).
Using 100 rejuvernation moves in order to target at least a 50% acceptence rate for each rejuvernation sample.
Fitting using PMCMC
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpZXm3qS/Baselineca95645dd3a3;/usr/local/bin/libbi sample --seed 1402360564 --input-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_inputca9549114ad0.nc --obs-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_obsca951e29ee60.nc --noutputs 73 --end-time 73 --nparticles 8 --nthreads 4 --verbose --nsamples 2000 --init-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_initca9571360b64.nc --sampler sir --adapter global --sample-ess-rel 0.5 --nmoves 100 --target posterior --output-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_outputca954a22b4b.nc --model-file /tmp/RtmpZXm3qS/Baselineca95645dd3a3/Baseline_modelca954e055f7f.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Summary of fitted model
Wrapper around LibBi
======================
Model:  Baseline 
