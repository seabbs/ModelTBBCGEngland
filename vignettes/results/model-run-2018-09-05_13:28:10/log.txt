Plot historic number of pulmonary cases detected each year:
Saving 7 x 7 in image
Plot number of cases detected each year:
Saving 7 x 7 in image
Plot number of cases detected each year, stratified by age group:
Saving 7 x 7 in image
Load the model as a compiled libbi object
Sample priors
Summary of prior sampling
Wrapper around LibBi
======================
Model:  Baseline 
Run time:  56.05465  seconds
Number of samples:  1000 
State trajectories recorded:  foi S H L P E T_P T_E N YearlyPulCases YearlyEPulCases YearlyPulDeaths YearlyEPulDeaths YearlyPAgeCases YearlyPCases YearlyEAgeCases YearlyECases YearlyAgeCases YearlyCases YearlyNonUKborn 
Parameters recorded:  M c_eff c_hist delta epsilon_h_0_4 epsilon_h_5_14 epsilon_h_15_89 kappa_0_4 kappa_5_14 kappa_15_89 epsilon_l_0_4 epsilon_l_5_14 epsilon_l_15_89 phi_0_14 phi_15_59 phi_60_89 Upsilon_0_14 Upsilon_15_59 Upsilon_60_89 rho_0_14 rho_15_59 rho_60_89 nu_p_0_14 nu_p_15_89 nu_e_0_14 nu_e_15_89 zeta_p_0_14 zeta_p_15_59 zeta_p_60_89 zeta_e_0_14 zeta_e_15_59 zeta_e_60_89 mu_p_0_14 mu_p_15_59 mu_p_60_89 mu_e_0_14 mu_e_15_59 mu_e_60_89 chi_init alpha_t HistMeasError 
Load priors
Plot priors
Aggregate function missing, defaulting to 'length'
Plotting: densities
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Saving 7 x 7 in image
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Plotting: traces
Saving 7 x 7 in image
Adapting proposal with a min acceptance of 0.2 and a maximum acceptance of 0.4
Running for 3 iterations with 1000 samples each time.
Wed Sep  5 13:34:49 2018 Adapting the proposal distribution
Wed Sep  5 13:34:49 2018 Acceptance rate 0.0370370370370371, adapting size with scale 1
Wed Sep  5 13:44:39 2018 Acceptance rate 0.056056056056056, adapting size with scale 0.5
Wed Sep  5 13:58:20 2018 Acceptance rate 0, adapting size with scale 0.25
Wed Sep  5 14:05:32 2018 Acceptance rate 0.00600600600600598, adapting shape with scale 1
Wed Sep  5 14:11:10 2018 Acceptance rate 0.012012012012012, adapting shape with scale 0.5
Wed Sep  5 14:16:36 2018 Acceptance rate 0.173173173173173, adapting shape with scale 0.25
Wed Sep  5 14:35:58 2018 Acceptance rate: 0.131131131131131
Adapted proposal distribution
 [1] "M ~ truncated_gaussian(mean = M, std = 1e-04, lower = 0, upper = 1)"                        
 [2] "c_eff ~ truncated_gaussian(mean = c_eff, std = 0.002, lower = 0, upper = 5)"                
 [3] "c_hist ~ truncated_gaussian(mean = c_hist, std = 0.004, lower = 10, upper = 15)"            
 [4] "delta ~ truncated_gaussian(mean = delta, std = 0.003, lower = 0, upper = 1)"                
 [5] "phi_0_14 ~ truncated_gaussian(mean = phi_0_14, std = 0.01, lower = 0)"                      
 [6] "phi_15_59 ~ truncated_gaussian(mean = phi_15_59, std = 0.007, lower = 0)"                   
 [7] "phi_60_89 ~ truncated_gaussian(mean = phi_60_89, std = 0.05, lower = 0)"                    
 [8] "Upsilon_0_14 ~ truncated_gaussian(mean = Upsilon_0_14, std = 6e-04, lower = 0, upper = 1)"  
 [9] "Upsilon_15_59 ~ truncated_gaussian(mean = Upsilon_15_59, std = 0.002, lower = 0, upper = 1)"
[10] "Upsilon_60_89 ~ truncated_gaussian(mean = Upsilon_60_89, std = 0.001, lower = 0, upper = 1)"
[11] "rho_0_14 ~ truncated_gaussian(mean = rho_0_14, std = 0.004, lower = 0, upper = 1)"          
[12] "rho_15_59 ~ truncated_gaussian(mean = rho_15_59, std = 0.002, lower = 0, upper = 1)"        
[13] "rho_60_89 ~ truncated_gaussian(mean = rho_60_89, std = 0.002, lower = 0, upper = 1)"        
[14] "nu_p_0_14 ~ truncated_gaussian(mean = nu_p_0_14, std = 0.006, lower = 0)"                   
[15] "nu_p_15_89 ~ truncated_gaussian(mean = nu_p_15_89, std = 6e-04, lower = 0)"                 
[16] "nu_e_0_14 ~ truncated_gaussian(mean = nu_e_0_14, std = 0.004, lower = 0)"                   
[17] "nu_e_15_89 ~ truncated_gaussian(mean = nu_e_15_89, std = 0.007, lower = 0)"                 
[18] "chi_init ~ truncated_gaussian(mean = chi_init, std = 8e-04, lower = 0, upper = 1)"          
[19] "HistMeasError ~ truncated_gaussian(mean = HistMeasError, std = 0.003, lower = 0)"           
[1] NA
Fitting using PMCMC
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/Rtmpl0tvef/Baseline1268b36382854;/usr/local/bin/libbi sample --seed 1172185779 --input-file /tmp/Rtmpl0tvef/Baseline1268b36382854/Baseline_input1268b4440f021.nc --obs-file /tmp/Rtmpl0tvef/Baseline1268b36382854/Baseline_obs1268b536f06ff.nc --end-time 73 --noutputs 73 --nparticles 16 --nthreads 8 --verbose --nsamples 10000 --init-file /tmp/Rtmpl0tvef/Baseline1268b36382854/Baseline_init1268b557b2129.nc --target posterior --output-file /tmp/Rtmpl0tvef/Baseline1268b36382854/Baseline_output1268b5e0d1389.nc --model-file /tmp/Rtmpl0tvef/Baseline1268b36382854/Baseline_model1268b62fb68fa.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
[1] "... LibBi has finished!"
Summary of fitted model
Wrapper around LibBi
======================
Model:  Baseline 
Run time:  5944.904  seconds
Number of samples:  10000 
State trajectories recorded:  foi S H L P E T_P T_E N YearlyPulCases YearlyEPulCases YearlyPulDeaths YearlyEPulDeaths YearlyPAgeCases YearlyPCases YearlyEAgeCases YearlyECases YearlyAgeCases YearlyCases YearlyNonUKborn 
Observation trajectories recorded:  YearlyHistPInc YearlyInc YearlyAgeInc 
Parameters recorded:  M c_eff c_hist delta epsilon_h_0_4 epsilon_h_5_14 epsilon_h_15_89 kappa_0_4 kappa_5_14 kappa_15_89 epsilon_l_0_4 epsilon_l_5_14 epsilon_l_15_89 phi_0_14 phi_15_59 phi_60_89 Upsilon_0_14 Upsilon_15_59 Upsilon_60_89 rho_0_14 rho_15_59 rho_60_89 nu_p_0_14 nu_p_15_89 nu_e_0_14 nu_e_15_89 zeta_p_0_14 zeta_p_15_59 zeta_p_60_89 zeta_e_0_14 zeta_e_15_59 zeta_e_60_89 mu_p_0_14 mu_p_15_59 mu_p_60_89 mu_e_0_14 mu_e_15_59 mu_e_60_89 chi_init alpha_t HistMeasError 
Plot posterior
Aggregate function missing, defaulting to 'length'
Plotting: densities
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Saving 7 x 7 in image
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Plotting: traces
Saving 7 x 7 in image
Model DIC: 3356957.73453526
