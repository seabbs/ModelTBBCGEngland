Plot historic number of pulmonary cases detected each year:
Saving 7 x 7 in image
Plot number of cases detected each year:
Saving 7 x 7 in image
Plot number of cases detected each year, stratified by age group:
Saving 7 x 7 in image
Load the model as a compiled libbi object
Sample priors
Summary of prior sampling
Wrapper around LibBi
======================
Model:  Baseline 
Run time:  47.767  seconds
Number of samples:  1000 
State trajectories recorded:  foi S H L P E T_P T_E N YearlyPulCases YearlyEPulCases YearlyPulDeaths YearlyEPulDeaths YearlyPAgeCases YearlyPCases YearlyEAgeCases YearlyECases YearlyAgeCases YearlyCases YearlyNonUKborn 
Parameters recorded:  M c_eff c_hist delta epsilon_h_0_4 epsilon_h_5_14 epsilon_h_15_89 kappa_0_4 kappa_5_14 kappa_15_89 epsilon_l_0_4 epsilon_l_5_14 epsilon_l_15_89 phi_0_14 phi_15_59 phi_60_89 Upsilon_0_14 Upsilon_15_59 Upsilon_60_89 rho_0_14 rho_15_59 rho_60_89 nu_p_0_14 nu_p_15_89 nu_e_0_14 nu_e_15_89 zeta_p_0_14 zeta_p_15_59 zeta_p_60_89 zeta_e_0_14 zeta_e_15_59 zeta_e_60_89 mu_p_0_14 mu_p_15_59 mu_p_60_89 mu_e_0_14 mu_e_15_59 mu_e_60_89 chi_init alpha_t HistMeasError 
Load priors
Plot priors
Aggregate function missing, defaulting to 'length'
Plotting: densities
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Saving 7 x 7 in image
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Plotting: traces
Saving 7 x 7 in image
Adapting proposal with a min acceptance of 0.1 and a maximum acceptance of 0.4
Running for 1000 with 10 samples each time.
Fri Aug 31 14:02:30 2018 Adapting the proposal distribution
Fri Aug 31 14:02:31 2018 Acceptance rate 1, adapting size with scale 1
Fri Aug 31 14:08:38 2018 Acceptance rate 0.00600600600600598, adapting size with scale 0.5
Fri Aug 31 14:15:20 2018 Acceptance rate 0.075075075075075, adapting size with scale 0.25
Fri Aug 31 14:24:00 2018 Acceptance rate 0.07007007007007, adapting size with scale 0.125
Fri Aug 31 14:35:07 2018 Acceptance rate 0.352352352352352, adapting shape with scale 1
Fri Aug 31 14:41:06 2018 Acceptance rate 0.0850850850850851, adapting shape with scale 0.5
Fri Aug 31 14:46:12 2018 Acceptance rate: 0.287287287287287
Adapted proposal distribution
 [1] "M ~ truncated_gaussian(mean = M, std = 0.007, lower = 0, upper = 0.5)"                      
 [2] "c_eff ~ truncated_gaussian(mean = c_eff, std = 0.07, lower = 0, upper = 5)"                 
 [3] "c_hist ~ truncated_gaussian(mean = c_hist, std = 0.2, lower = 10, upper = 15)"              
 [4] "delta ~ truncated_gaussian(mean = delta, std = 0.005, lower = 0, upper = 1)"                
 [5] "phi_0_14 ~ truncated_gaussian(mean = phi_0_14, std = 0.007, lower = 0)"                     
 [6] "phi_15_59 ~ truncated_gaussian(mean = phi_15_59, std = 0.04, lower = 0)"                    
 [7] "phi_60_89 ~ truncated_gaussian(mean = phi_60_89, std = 0.008, lower = 0)"                   
 [8] "Upsilon_0_14 ~ truncated_gaussian(mean = Upsilon_0_14, std = 0.001, lower = 0, upper = 1)"  
 [9] "Upsilon_15_59 ~ truncated_gaussian(mean = Upsilon_15_59, std = 6e-05, lower = 0, upper = 1)"
[10] "Upsilon_60_89 ~ truncated_gaussian(mean = Upsilon_60_89, std = 8e-04, lower = 0, upper = 1)"
[11] "rho_0_14 ~ truncated_gaussian(mean = rho_0_14, std = 9e-04, lower = 0, upper = 1)"          
[12] "rho_15_59 ~ truncated_gaussian(mean = rho_15_59, std = 6e-04, lower = 0, upper = 1)"        
[13] "rho_60_89 ~ truncated_gaussian(mean = rho_60_89, std = 1e-04, lower = 0, upper = 1)"        
[14] "nu_p_0_14 ~ truncated_gaussian(mean = nu_p_0_14, std = 3e-04, lower = 0)"                   
[15] "nu_p_15_89 ~ truncated_gaussian(mean = nu_p_15_89, std = 0.005, lower = 0)"                 
[16] "nu_e_0_14 ~ truncated_gaussian(mean = nu_e_0_14, std = 0.008, lower = 0)"                   
[17] "nu_e_15_89 ~ truncated_gaussian(mean = nu_e_15_89, std = 0.09, lower = 0)"                  
[18] "chi_init ~ truncated_gaussian(mean = chi_init, std = 0.005, lower = 0, upper = 1)"          
[19] "HistMeasError ~ truncated_gaussian(mean = HistMeasError, std = 0.001, lower = 0)"           
[1] NA
Fitting using PMCMC
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpIm35PB/Baseline120f157037a14;/usr/local/bin/libbi sample --seed 23965747 --input-file /tmp/RtmpIm35PB/Baseline120f157037a14/Baseline_input120f17bd56e0e.nc --obs-file /tmp/RtmpIm35PB/Baseline120f157037a14/Baseline_obs120f150d5cefd.nc --end-time 73 --noutputs 73 --nparticles 8 --nthreads 8 --verbose --nsamples 2000 --init-file /tmp/RtmpIm35PB/Baseline120f157037a14/Baseline_init120f14276e341.nc --target posterior --output-file /tmp/RtmpIm35PB/Baseline120f157037a14/Baseline_output120f128fb9681.nc --model-file /tmp/RtmpIm35PB/Baseline120f157037a14/Baseline_model120f1762d0a9c.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
[1] "... LibBi has finished!"
Summary of fitted model
Wrapper around LibBi
======================
Model:  Baseline 
Run time:  356.0229  seconds
Number of samples:  2000 
State trajectories recorded:  foi S H L P E T_P T_E N YearlyPulCases YearlyEPulCases YearlyPulDeaths YearlyEPulDeaths YearlyPAgeCases YearlyPCases YearlyEAgeCases YearlyECases YearlyAgeCases YearlyCases YearlyNonUKborn 
Observation trajectories recorded:  YearlyHistPInc YearlyInc YearlyAgeInc 
Parameters recorded:  M c_eff c_hist delta epsilon_h_0_4 epsilon_h_5_14 epsilon_h_15_89 kappa_0_4 kappa_5_14 kappa_15_89 epsilon_l_0_4 epsilon_l_5_14 epsilon_l_15_89 phi_0_14 phi_15_59 phi_60_89 Upsilon_0_14 Upsilon_15_59 Upsilon_60_89 rho_0_14 rho_15_59 rho_60_89 nu_p_0_14 nu_p_15_89 nu_e_0_14 nu_e_15_89 zeta_p_0_14 zeta_p_15_59 zeta_p_60_89 zeta_e_0_14 zeta_e_15_59 zeta_e_60_89 mu_p_0_14 mu_p_15_59 mu_p_60_89 mu_e_0_14 mu_e_15_59 mu_e_60_89 chi_init alpha_t HistMeasError 
Plot posterior
Aggregate function missing, defaulting to 'length'
Plotting: densities
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Saving 7 x 7 in image
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Plotting: traces
Saving 7 x 7 in image
Model DIC: 21591.2971438895
