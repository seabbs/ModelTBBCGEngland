Plot historic number of pulmonary cases detected each year:
Saving 7 x 7 in image
Plot number of cases detected each year:
Saving 7 x 7 in image
Plot number of cases detected each year, stratified by age group:
Saving 7 x 7 in image
Using a minimum of 2 particles based on the number of observed data samples divided by two.
Using a maximum of 8 particles based on the minimum number of particles times by 4.
Load the model as a compiled libbi object
Sample priors
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpzGVpfe/Baseline13bc1744eb039;/usr/local/bin/libbi sample --seed 850941453 --input-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_input13bc16c24a006.nc --noutputs 73 --end-time 73 --nparticles 4 --nthreads 4 --verbose --target prior --nsamples 100 --output-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_output13bc16a40d265.nc --model-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_model13bc15eb70f8a.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                              
[1] "... LibBi has finished!"
Summary of prior sampling
Wrapper around LibBi
======================
Model:  Baseline 
Run time:  43.40972  seconds
Number of samples:  100 
State trajectories recorded:  foi S H L P E T_P T_E YearlyPulCases YearlyEPulCases YearlyPulDeaths YearlyEPulDeaths YearlyPAgeCases YearlyPCases YearlyEAgeCases YearlyECases YearlyAgeCases YearlyCases YearlyNonUKborn 
Observation trajectories recorded:  YearlyHistPInc YearlyInc YearlyAgeInc 
Parameters recorded:  M c_eff c_hist delta epsilon_h_0_4 epsilon_h_5_14 epsilon_h_15_89 kappa_0_4 kappa_5_14 kappa_15_89 epsilon_l_0_4 epsilon_l_5_14 epsilon_l_15_89 phi_0_14 phi_15_69 phi_70_89 Upsilon_0_14 Upsilon_15_69 Upsilon_70_89 rho_0_14 rho_15_69 rho_70_89 nu_p_0_14 nu_p_15_89 nu_e_0_14 nu_e_15_89 zeta_0_14 zeta_15_69 zeta_70_89 mu_p_0_14 mu_p_15_69 mu_p_70_89 mu_e_0_14 mu_e_15_69 mu_e_70_89 chi_init alpha_t_init alpha_t_decay HistMeasError 
Load priors
Plot priors
Plotting: densities
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Saving 7 x 7 in image
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Plotting: traces
Saving 7 x 7 in image
Adapting proposal with a min acceptance of 0.2 and a maximum acceptance of 0.4
Running for 1 iterations with 100 samples each time.
Taking initial sample to estimate acceptance rate
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpzGVpfe/Baseline13bc1744eb039;/usr/local/bin/libbi sample --seed 1279039724 --input-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_input13bc16c24a006.nc --obs-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_obs13bc1645b69e4.nc --noutputs 73 --end-time 73 --nparticles 4 --nthreads 4 --verbose --nsamples 100 --output-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_output13bc112cd541.nc --model-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_model13bc122f1fe55.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
[1] "... LibBi has finished!"
Adapting proposal ...
Thu Sep 20 15:14:08 2018 Adapting the proposal distribution
Thu Sep 20 15:14:08 2018 Acceptance rate 1, adapting size with scale 1
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpzGVpfe/Baseline13bc1744eb039;/usr/local/bin/libbi sample --seed 915682483 --input-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_input13bc16c24a006.nc --obs-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_obs13bc1645b69e4.nc --noutputs 73 --end-time 73 --nparticles 4 --nthreads 4 --verbose --nsamples 100 --init-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_init13bc17535c1f4.nc --output-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_output13bc12ffdf811.nc --model-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_model13bc12f0902aa.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
[1] "... LibBi has finished!"
Thu Sep 20 15:17:14 2018 Acceptance rate 0.0303030303030303, adapting shape with scale 1
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpzGVpfe/Baseline13bc1744eb039;/usr/local/bin/libbi sample --seed 1853107402 --input-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_input13bc16c24a006.nc --obs-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_obs13bc1645b69e4.nc --noutputs 73 --end-time 73 --nparticles 4 --nthreads 4 --verbose --nsamples 100 --init-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_init13bc161ff8d75.nc --output-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_output13bc1732a7e88.nc --model-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_model13bc15994c1da.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
[1] "... LibBi has finished!"
Thu Sep 20 15:18:16 2018 Acceptance rate: 0
Adapted proposal distribution
 [1] "M ~ truncated_gaussian(mean = M, std = 0.002, lower = 0, upper = 0.5)"                      
 [2] "c_eff ~ truncated_gaussian(mean = c_eff, std = 0.09, lower = 0, upper = 5)"                 
 [3] "c_hist ~ truncated_gaussian(mean = c_hist, std = 0.05, lower = 10, upper = 15)"             
 [4] "delta ~ truncated_gaussian(mean = delta, std = 0.007, lower = 0, upper = 1)"                
 [5] "epsilon_h_0_4 ~ truncated_gaussian(mean = epsilon_h_0_4, std = 0.08, lower = 0)"            
 [6] "epsilon_h_5_14 ~ truncated_gaussian(mean = epsilon_h_5_14, std = 0.4, lower = 0)"           
 [7] "epsilon_h_15_89 ~ truncated_gaussian(mean = epsilon_h_15_89, std = 2, lower = 0)"           
 [8] "kappa_0_4 ~ truncated_gaussian(mean = kappa_0_4, std = 0.3, lower = 0)"                     
 [9] "kappa_5_14 ~ truncated_gaussian(mean = kappa_5_14, std = 0.03, lower = 0)"                  
[10] "kappa_15_89 ~ truncated_gaussian(mean = kappa_15_89, std = 0.03, lower = 0)"                
[11] "epsilon_l_0_4 ~ truncated_gaussian(mean = epsilon_l_0_4, std = 20, lower = 0)"              
[12] "epsilon_l_5_14 ~ truncated_gaussian(mean = epsilon_l_5_14, std = 20, lower = 0)"            
[13] "epsilon_l_15_89 ~ truncated_gaussian(mean = epsilon_l_15_89, std = 5, lower = 0)"           
[14] "phi_0_14 ~ truncated_gaussian(mean = phi_0_14, std = 0.003, lower = 0)"                     
[15] "phi_15_69 ~ truncated_gaussian(mean = phi_15_69, std = 0.03, lower = 0)"                    
[16] "phi_70_89 ~ truncated_gaussian(mean = phi_70_89, std = 0.05, lower = 0)"                    
[17] "Upsilon_0_14 ~ truncated_gaussian(mean = Upsilon_0_14, std = 4e-04, lower = 0, upper = 1)"  
[18] "Upsilon_15_69 ~ truncated_gaussian(mean = Upsilon_15_69, std = 4e-04, lower = 0, upper = 1)"
[19] "Upsilon_70_89 ~ truncated_gaussian(mean = Upsilon_70_89, std = 6e-04, lower = 0, upper = 1)"
[20] "rho_0_14 ~ truncated_gaussian(mean = rho_0_14, std = 8e-04, lower = 0, upper = 1)"          
[21] "rho_15_69 ~ truncated_gaussian(mean = rho_15_69, std = 9e-05, lower = 0, upper = 1)"        
[22] "rho_70_89 ~ truncated_gaussian(mean = rho_70_89, std = 5e-04, lower = 0, upper = 1)"        
[23] "nu_p_0_14 ~ truncated_gaussian(mean = nu_p_0_14, std = 0.004, lower = 0)"                   
[24] "nu_p_15_89 ~ truncated_gaussian(mean = nu_p_15_89, std = 0.03, lower = 0)"                  
[25] "nu_e_0_14 ~ truncated_gaussian(mean = nu_e_0_14, std = 0.005, lower = 0)"                   
[26] "nu_e_15_89 ~ truncated_gaussian(mean = nu_e_15_89, std = 0.01, lower = 0)"                  
[27] "zeta_0_14 ~ truncated_gaussian(mean = zeta_0_14, std = 9, lower = 0)"                       
[28] "zeta_15_69 ~ truncated_gaussian(mean = zeta_15_69, std = 30, lower = 0)"                    
[29] "zeta_70_89 ~ truncated_gaussian(mean = zeta_70_89, std = 20, lower = 0)"                    
[30] "mu_p_0_14 ~ truncated_gaussian(mean = mu_p_0_14, std = 1, lower = 0)"                       
[31] "mu_p_15_69 ~ truncated_gaussian(mean = mu_p_15_69, std = 7, lower = 0)"                     
[32] "mu_p_70_89 ~ truncated_gaussian(mean = mu_p_70_89, std = 3, lower = 0)"                     
[33] "mu_e_0_14 ~ truncated_gaussian(mean = mu_e_0_14, std = 3, lower = 0)"                       
[34] "mu_e_15_69 ~ truncated_gaussian(mean = mu_e_15_69, std = 0.8, lower = 0)"                   
[35] "mu_e_70_89 ~ truncated_gaussian(mean = mu_e_70_89, std = 0.3, lower = 0)"                   
[36] "chi_init ~ truncated_gaussian(mean = chi_init, std = 0.03, lower = 0, upper = 1)"           
[37] "alpha_t_init ~ gaussian(mean = alpha_t_init, std = 0.1)"                                    
[38] "alpha_t_decay ~ gaussian(mean = alpha_t_decay, std = 0.003)"                                
[39] "HistMeasError ~ truncated_gaussian(mean = HistMeasError, std = 0.008, lower = 0)"           
[1] NA
Fitting using PMCMC
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpzGVpfe/Baseline13bc1744eb039;/usr/local/bin/libbi sample --seed 229872174 --input-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_input13bc16c24a006.nc --obs-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_obs13bc1645b69e4.nc --noutputs 73 --end-time 73 --nparticles 4 --nthreads 4 --verbose --nsamples 100 --init-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_init13bc176b297ff.nc --sampler sir --adapter none --sample-ess-rel 0.8 --nmoves 10 --target posterior --output-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_output13bc1daba072.nc --model-file /tmp/RtmpzGVpfe/Baseline13bc1744eb039/Baseline_model13bc1688587ec.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
[1] "... LibBi has finished!"
Summary of fitted model
Wrapper around LibBi
======================
Model:  Baseline 
Run time:  8949.138  seconds
Number of samples:  100 
State trajectories recorded:  foi S H L P E T_P T_E YearlyPulCases YearlyEPulCases YearlyPulDeaths YearlyEPulDeaths YearlyPAgeCases YearlyPCases YearlyEAgeCases YearlyECases YearlyAgeCases YearlyCases YearlyNonUKborn 
Observation trajectories recorded:  YearlyHistPInc YearlyInc YearlyAgeInc 
Parameters recorded:  M c_eff c_hist delta epsilon_h_0_4 epsilon_h_5_14 epsilon_h_15_89 kappa_0_4 kappa_5_14 kappa_15_89 epsilon_l_0_4 epsilon_l_5_14 epsilon_l_15_89 phi_0_14 phi_15_69 phi_70_89 Upsilon_0_14 Upsilon_15_69 Upsilon_70_89 rho_0_14 rho_15_69 rho_70_89 nu_p_0_14 nu_p_15_89 nu_e_0_14 nu_e_15_89 zeta_0_14 zeta_15_69 zeta_70_89 mu_p_0_14 mu_p_15_69 mu_p_70_89 mu_e_0_14 mu_e_15_69 mu_e_70_89 chi_init alpha_t_init alpha_t_decay HistMeasError 
Plot posterior
Plotting: densities
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Saving 7 x 7 in image
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Plotting: traces
Saving 7 x 7 in image
Model DIC: 4068.92561979686
Predicting states based on posterior sample up to 2040
Creating model report


processing file: model_report.Rmd
  |                                                                         |                                                                 |   0%  |                                                                         |..                                                               |   3%
   inline R code fragments

  |                                                                         |....                                                             |   7%
label: setup (with options) 
List of 1
 $ include: logi FALSE

  |                                                                         |......                                                           |  10%
  ordinary text without R code

  |                                                                         |.........                                                        |  13%
label: packages (with options) 
List of 1
 $ include: logi FALSE

  |                                                                         |...........                                                      |  17%
  ordinary text without R code

  |                                                                         |.............                                                    |  20%
label: load-model
  |                                                                         |...............                                                  |  23%
  ordinary text without R code

  |                                                                         |.................                                                |  27%
label: unnamed-chunk-1
  |                                                                         |....................                                             |  30%
  ordinary text without R code

  |                                                                         |......................                                           |  33%
label: auto-corr-plot
  |                                                                         |........................                                         |  37%
  ordinary text without R code

  |                                                                         |..........................                                       |  40%
label: posterior-traces (with options) 
List of 2
 $ fig.width : num 16
 $ fig.height: num 16

  |                                                                         |............................                                     |  43%
  ordinary text without R code

  |                                                                         |..............................                                   |  47%
label: prior-posterior-overview (with options) 
List of 2
 $ fig.height: num 16
 $ fig.width : num 16

  |                                                                         |................................                                 |  50%
  ordinary text without R code

  |                                                                         |...................................                              |  53%
label: param-overview (with options) 
List of 2
 $ fig.height: num 16
 $ fig.width : num 16

  |                                                                         |.....................................                            |  57%
  ordinary text without R code

  |                                                                         |.......................................                          |  60%
label: overview-states (with options) 
List of 2
 $ fig.height: num 16
 $ fig.width : num 16

  |                                                                         |.........................................                        |  63%
  ordinary text without R code

  |                                                                         |...........................................                      |  67%
label: overview-states-1990 (with options) 
List of 2
 $ fig.height: num 16
 $ fig.width : num 16

  |                                                                         |..............................................                   |  70%
  ordinary text without R code

  |                                                                         |................................................                 |  73%
label: overview-states-1980-obs
Quitting from lines 114-117 (model_report.Rmd) 
Error: Column `np` is unknown
In addition: There were 15 warnings (use warnings() to see them)

Execution halted
