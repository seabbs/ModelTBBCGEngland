Plot historic number of pulmonary cases detected each year:
Saving 7 x 7 in image
Plot number of cases detected each year:
Saving 7 x 7 in image
Plot number of cases detected each year, stratified by age group:
Saving 7 x 7 in image
Using 33 particles based on the number of observed data samples.
Using a minimum of 16 particles based on the number of observed data samples divided by two.
Using a maximum of 64 particles based on the minimum number of particles times by 4.
Load the model as a compiled libbi object
Sample priors
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpQewNgE/Baseline1af5410e9bdd;/usr/local/bin/libbi sample --seed 1359698801 --input-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_input1af525845725.nc --end-time 73 --nparticles 33 --nthreads 34 --verbose --target prior --nsamples 1000 --output-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_output1af5653c079f.nc --model-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_model1af553df9f2e.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                             
[1] "... LibBi has finished!"
Summary of prior sampling
Wrapper around LibBi
======================
Model:  Baseline 
Run time:  111.0114  seconds
Number of samples:  1000 
State trajectories recorded:  S H L P E T_P T_E YearlyPulCases YearlyEPulCases YearlyPulDeaths YearlyEPulDeaths YearlyPAgeCases YearlyPCases YearlyEAgeCases YearlyECases YearlyAgeCases YearlyCases YearlyNonUKborn 
Parameters recorded:  M c_eff c_hist delta epsilon_h_0_4 epsilon_h_5_14 epsilon_h_15_89 kappa_0_4 kappa_5_14 kappa_15_89 epsilon_l_0_4 epsilon_l_5_14 epsilon_l_15_89 phi_0_14 phi_15_69 phi_70_89 Upsilon_0_14 Upsilon_15_69 Upsilon_70_89 rho_0_14 rho_15_69 rho_70_89 nu_p_0_14 nu_p_15_89 nu_e_0_14 nu_e_15_89 zeta_0_14 zeta_15_69 zeta_70_89 mu_p_0_14 mu_p_15_69 mu_p_70_89 mu_e_0_14 mu_e_15_69 mu_e_70_89 chi_init alpha_t_init alpha_t_decay HistMeasError 
Load priors
Plot priors
Plotting: densities
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Saving 7 x 7 in image
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Plotting: traces
Saving 7 x 7 in image
Adapting proposal with a min acceptance of 0.2 and a maximum acceptance of 0.4
Running for 3 iterations with 100 samples each time.
Taking initial sample to estimate acceptance rate
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpQewNgE/Baseline1af5410e9bdd;/usr/local/bin/libbi sample --seed 1064656696 --input-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_input1af525845725.nc --obs-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_obs1af57347af2f.nc --end-time 73 --nparticles 33 --nthreads 34 --verbose --nsamples 100 --output-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_output1af54ad44364.nc --model-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_model1af5cf44a7.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
[1] "... LibBi has finished!"
Adapting proposal ...
Wed Sep 19 12:52:29 2018 Adapting the proposal distribution
Wed Sep 19 12:52:30 2018 Acceptance rate 1, adapting size with scale 1
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpQewNgE/Baseline1af5410e9bdd;/usr/local/bin/libbi sample --seed 1939573794 --input-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_input1af525845725.nc --obs-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_obs1af57347af2f.nc --end-time 73 --nparticles 33 --nthreads 34 --verbose --nsamples 100 --init-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_init1af533fb4ae8.nc --output-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_output1af55a795538.nc --model-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_model1af53c179eef.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
[1] "... LibBi has finished!"
Wed Sep 19 13:02:22 2018 Acceptance rate 0.0505050505050505, adapting size with scale 0.5
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpQewNgE/Baseline1af5410e9bdd;/usr/local/bin/libbi sample --seed 1872417763 --input-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_input1af525845725.nc --obs-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_obs1af57347af2f.nc --end-time 73 --nparticles 33 --nthreads 34 --verbose --nsamples 100 --init-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_init1af53e81fde8.nc --output-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_output1af552f48af3.nc --model-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_model1af5ab92985.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
[1] "... LibBi has finished!"
Wed Sep 19 13:09:06 2018 Acceptance rate 0.0101010101010101, adapting size with scale 0.25
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpQewNgE/Baseline1af5410e9bdd;/usr/local/bin/libbi sample --seed 789925240 --input-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_input1af525845725.nc --obs-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_obs1af57347af2f.nc --end-time 73 --nparticles 33 --nthreads 34 --verbose --nsamples 100 --init-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_init1af5110a6e10.nc --output-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_output1af523a91590.nc --model-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_model1af51b1a5f5.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
[1] "... LibBi has finished!"
Wed Sep 19 13:30:03 2018 Acceptance rate 0.0101010101010101, adapting shape with scale 1
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpQewNgE/Baseline1af5410e9bdd;/usr/local/bin/libbi sample --seed 1748127379 --input-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_input1af525845725.nc --obs-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_obs1af57347af2f.nc --end-time 73 --nparticles 33 --nthreads 34 --verbose --nsamples 100 --init-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_init1af5392500c8.nc --output-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_output1af55916c599.nc --model-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_model1af522e4924d.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
[1] "... LibBi has finished!"
Wed Sep 19 13:51:18 2018 Acceptance rate 0, adapting shape with scale 0.5
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpQewNgE/Baseline1af5410e9bdd;/usr/local/bin/libbi sample --seed 1104934134 --input-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_input1af525845725.nc --obs-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_obs1af57347af2f.nc --end-time 73 --nparticles 33 --nthreads 34 --verbose --nsamples 100 --init-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_init1af551425089.nc --output-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_output1af56e7ca181.nc --model-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_model1af5e15d185.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
[1] "... LibBi has finished!"
Wed Sep 19 13:59:46 2018 Acceptance rate 0, adapting shape with scale 0.25
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpQewNgE/Baseline1af5410e9bdd;/usr/local/bin/libbi sample --seed 512758791 --input-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_input1af525845725.nc --obs-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_obs1af57347af2f.nc --end-time 73 --nparticles 33 --nthreads 34 --verbose --nsamples 100 --init-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_init1af5390950e9.nc --output-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_output1af52b9ffbd9.nc --model-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_model1af53b780222.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
[1] "... LibBi has finished!"
Wed Sep 19 14:10:15 2018 Acceptance rate: 0
Adapted proposal distribution
 [1] "M ~ truncated_gaussian(mean = M, std = 0.005, lower = 0, upper = 0.5)"                     
 [2] "c_eff ~ truncated_gaussian(mean = c_eff, std = 0.05, lower = 0, upper = 5)"                
 [3] "c_hist ~ truncated_gaussian(mean = c_hist, std = 0.05, lower = 10, upper = 15)"            
 [4] "delta ~ truncated_gaussian(mean = delta, std = 0.01, lower = 0, upper = 1)"                
 [5] "epsilon_h_0_4 ~ truncated_gaussian(mean = epsilon_h_0_4, std = 0.1, lower = 0)"            
 [6] "epsilon_h_5_14 ~ truncated_gaussian(mean = epsilon_h_5_14, std = 0.1, lower = 0)"          
 [7] "epsilon_h_15_89 ~ truncated_gaussian(mean = epsilon_h_15_89, std = 0.1, lower = 0)"        
 [8] "kappa_0_4 ~ truncated_gaussian(mean = kappa_0_4, std = 0.1, lower = 0)"                    
 [9] "kappa_5_14 ~ truncated_gaussian(mean = kappa_5_14, std = 0.1, lower = 0)"                  
[10] "kappa_15_89 ~ truncated_gaussian(mean = kappa_15_89, std = 0.1, lower = 0)"                
[11] "epsilon_l_0_4 ~ truncated_gaussian(mean = epsilon_l_0_4, std = 0.1, lower = 0)"            
[12] "epsilon_l_5_14 ~ truncated_gaussian(mean = epsilon_l_5_14, std = 0.1, lower = 0)"          
[13] "epsilon_l_15_89 ~ truncated_gaussian(mean = epsilon_l_15_89, std = 0.1, lower = 0)"        
[14] "phi_0_14 ~ truncated_gaussian(mean = phi_0_14, std = 0.1, lower = 0)"                      
[15] "phi_15_69 ~ truncated_gaussian(mean = phi_15_69, std = 0.1, lower = 0)"                    
[16] "phi_70_89 ~ truncated_gaussian(mean = phi_70_89, std = 0.1, lower = 0)"                    
[17] "Upsilon_0_14 ~ truncated_gaussian(mean = Upsilon_0_14, std = 0.01, lower = 0, upper = 1)"  
[18] "Upsilon_15_69 ~ truncated_gaussian(mean = Upsilon_15_69, std = 0.01, lower = 0, upper = 1)"
[19] "Upsilon_70_89 ~ truncated_gaussian(mean = Upsilon_70_89, std = 0.01, lower = 0, upper = 1)"
[20] "rho_0_14 ~ truncated_gaussian(mean = rho_0_14, std = 0.01, lower = 0, upper = 1)"          
[21] "rho_15_69 ~ truncated_gaussian(mean = rho_15_69, std = 0.01, lower = 0, upper = 1)"        
[22] "rho_70_89 ~ truncated_gaussian(mean = rho_70_89, std = 0.01, lower = 0, upper = 1)"        
[23] "nu_p_0_14 ~ truncated_gaussian(mean = nu_p_0_14, std = 0.1, lower = 0)"                    
[24] "nu_p_15_89 ~ truncated_gaussian(mean = nu_p_15_89, std = 0.1, lower = 0)"                  
[25] "nu_e_0_14 ~ truncated_gaussian(mean = nu_e_0_14, std = 0.1, lower = 0)"                    
[26] "nu_e_15_89 ~ truncated_gaussian(mean = nu_e_15_89, std = 0.1, lower = 0)"                  
[27] "zeta_0_14 ~ truncated_gaussian(mean = zeta_0_14, std = 0.1, lower = 0)"                    
[28] "zeta_15_69 ~ truncated_gaussian(mean = zeta_15_69, std = 0.1, lower = 0)"                  
[29] "zeta_70_89 ~ truncated_gaussian(mean = zeta_70_89, std = 0.1, lower = 0)"                  
[30] "mu_p_0_14 ~ truncated_gaussian(mean = mu_p_0_14, std = 0.1, lower = 0)"                    
[31] "mu_p_15_69 ~ truncated_gaussian(mean = mu_p_15_69, std = 0.1, lower = 0)"                  
[32] "mu_p_70_89 ~ truncated_gaussian(mean = mu_p_70_89, std = 0.1, lower = 0)"                  
[33] "mu_e_0_14 ~ truncated_gaussian(mean = mu_e_0_14, std = 0.1, lower = 0)"                    
[34] "mu_e_15_69 ~ truncated_gaussian(mean = mu_e_15_69, std = 0.1, lower = 0)"                  
[35] "mu_e_70_89 ~ truncated_gaussian(mean = mu_e_70_89, std = 0.1, lower = 0)"                  
[36] "chi_init ~ truncated_gaussian(mean = chi_init, std = 0.01, lower = 0, upper = 1)"          
[37] "alpha_t_init ~ gaussian(mean = alpha_t_init, std = 0.1)"                                   
[38] "alpha_t_decay ~ gaussian(mean = alpha_t_decay, std = 0.1)"                                 
[39] "HistMeasError ~ truncated_gaussian(mean = HistMeasError, std = 0.1, lower = 0)"            
[1] NA
Acceptance rate of 0 after adapting the proposal
Using Inf in order to target at least a 20% acceptence rate of the MCMC sampler.
Fitting using PMCMC
[1] "Launching LibBi with the following commands:"
[1] "cd /tmp/RtmpQewNgE/Baseline1af5410e9bdd;/usr/local/bin/libbi sample --seed 1325283119 --input-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_input1af525845725.nc --obs-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_obs1af57347af2f.nc --end-time 73 --nparticles 33 --nthreads 34 --verbose --nsamples 1000 --init-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_init1af5205ae2b3.nc --sampler sir --adapter none --sample-ess-rel 0.8 --nmoves Inf --target posterior --output-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_output1af53332cb4f.nc --model-file /tmp/RtmpQewNgE/Baseline1af5410e9bdd/Baseline_model1af517a8b167.bi "
[2] ""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
Summary of fitted model
Wrapper around LibBi
======================
Model:  Baseline 
Error in if (x$timestamp < file.mtime(x$output_file_name)) { : 
  missing value where TRUE/FALSE needed
Calls: fit_model ... print.libbi -> assert_output -> assert_output.libbi
In addition: Warning messages:
1: In readLines(filename) :
  incomplete final line found on '/usr/local/lib/R/site-library/ModelTBBCGEngland/bi/BaseLineModel.bi'
2: In plot.libbi(priors, plot = FALSE) :
  Correlations plot currently deactivated because of problems with the 'GGally' package
3: In plot.libbi(priors, plot = FALSE) :
  Pairs plot currently deactivated because of problems with the 'GGally' package
4: In adapt_proposal(., min = min_acc, max = max_acc, max_iter = adapt_prop_it,  :
  Maximum of iterations reached
5: In output_to_proposal(adapted, adapt_scale, correlations = (round ==  :
  Cholesky decomposition failed; will try to adapt via independent univariate sampling first.
6: In output_to_proposal(adapted, adapt_scale, correlations = (round ==  :
  Cholesky decomposition failed; will try to adapt via independent univariate sampling first.
7: In output_to_proposal(adapted, adapt_scale, correlations = (round ==  :
  Cholesky decomposition failed; will try to adapt via independent univariate sampling first.
8: In adapt_proposal(., min = min_acc, max = max_acc, max_iter = adapt_prop_it,  :
  Maximum of iterations reached
9: In run.libbi(x, client = "sample", ...) :
  LibBi terminated with an error.
Execution halted
